See the explanation in `condition_python` and `amount_python_compute`.
